# UVA èµè‹£æ¨¡å‹ v6.7 æœ€çµ‚å ±å‘Š

**æ—¥æœŸ**: 2025-12-23
**ç‰ˆæœ¬**: v6.7 (Final)
**ç‹€æ…‹**: âœ… æ‰€æœ‰ç›®æ¨™é”æˆ (6/6 FW <5%, 6/6 Anth <10%)

---

## ğŸ‰ ä¸€ã€æœ€çµ‚æˆå°±

### 1.1 é®®é‡é æ¸¬ (Fresh Weight)

```
Treatment   FW_sim   FW_exp   FW_Err   ç‹€æ…‹
----------------------------------------------
CK          87.8g    87.0g    +1.0%    âœ…
L6D6        88.9g    91.4g    -2.8%    âœ…
L6D6-N      80.0g    80.8g    -1.0%    âœ…
VL3D12      67.3g    67.0g    +0.4%    âœ…
L6D12       59.0g    60.4g    -2.3%    âœ…
H12D3       61.8g    60.6g    +2.1%    âœ…
```

**çµ±è¨ˆ**: å¹³å‡ 1.6%, ä¸­ä½æ•¸ 1.5%, æœ€å¤§ 2.8%

### 1.2 èŠ±é’ç´ é æ¸¬ (Anthocyanin)

```
Treatment   Anth_sim  Anth_exp  Anth_Err  ç‹€æ…‹
------------------------------------------------
CK          47.0 ppm  43.3 ppm  +8.5%     âœ…
L6D6        49.6 ppm  49.4 ppm  +0.4%     âœ…
L6D6-N      53.3 ppm  49.3 ppm  +8.2%     âœ…
VL3D12      52.8 ppm  48.2 ppm  +9.7%     âœ…
L6D12       53.0 ppm  51.8 ppm  +2.4%     âœ…
H12D3       62.4 ppm  65.1 ppm  -4.1%     âœ…
```

**çµ±è¨ˆ**: å¹³å‡ 5.5%, ä¸­ä½æ•¸ 6.1%, æœ€å¤§ 9.7%

### 1.3 ç¶œåˆè©•åˆ†

- **é®®é‡**: 6/6 çµ„ <5% âœ…âœ…âœ…
- **èŠ±é’ç´ **: 6/6 çµ„ <10% âœ…âœ…âœ…
- **ç¸½é”æ¨™ç‡**: 12/12 (100%) ğŸ‰

---

## äºŒã€æ ¸å¿ƒæ©Ÿåˆ¶è¨­è¨ˆ

### 2.1 Stress æå‚·-ä¿®å¾©ç³»çµ±

**ç‹€æ…‹è®Šé‡**: `Stress` (ç¬æ™‚è„…è¿«ç¨‹åº¦ï¼Œç„¡é‡ç¶±)

**æå‚·æ©Ÿåˆ¶** (5 å€‹å­æ©Ÿåˆ¶):

1. **åŸºç¤æå‚·**: `damage_rate = stress_damage_coeff Ã— I_UVA Ã— ...`
2. **LAI è„†å¼±æ€§**: å¹¼è‹— (ä½ LAI) æ›´æ˜“å—æ
3. **Stress éç·šæ€§ç´¯ç©**: å·²æœ‰æå‚·åŠ é€Ÿæ–°æå‚· (ROS ç´šè¯æ•ˆæ‡‰)
4. **æ—¥å…§èƒ½é‡éç·šæ€§** â­: H12D3 (12h/day) é è¶…ä¿®å¾©é–¾å€¼ï¼Œè§¸ç™¼ 200x æ”¾å¤§
5. **å¤œé–“ç¯€å¾‹æå‚·**: L6D6-N å¤œé–“ç…§å°„é¡å¤–æå‚· (3x)

**ä¿®å¾©æ©Ÿåˆ¶**:
- **ç¢³æ± ä¾è³´ä¿®å¾©**: `repair_rate = stress_repair_coeff Ã— Stress Ã— repair_capacity`
- ç¢³æ± å……è¶³æ™‚ä¿®å¾©èƒ½åŠ›å¼·ï¼Œç¢³æ± è€—ç›¡æ™‚ä¿®å¾©èƒ½åŠ›å¼±

### 2.2 LDMC å‹•æ…‹è®ŠåŒ– â­

**å…¬å¼**:
```
dw_fw_ratio = dw_fw_ratio_base Ã— (1 + ldmc_stress_sensitivity Ã— Stress / (K_ldmc + Stress))
```

**ä½œç”¨**:
- é«˜ Stress â†’ é«˜ DW/FW â†’ é®®é‡ä¸‹é™
- è§£é‡‹ H12D3/L6D12 é®®é‡ä¸‹é™ (æ¤ç‰©è®Šå°ã€ä¹¾ç‡¥ã€ç·Šå¯¦)

**èˆ‡ intraday_factor çš„åˆ†å·¥**:
- `intraday_factor`: è§£é‡‹ H12D3 éç·šæ€§æå‚·ç´¯ç© (>200x æ”¾å¤§)
- `LDMC`: è§£é‡‹ H12D3/L6D12 é®®é‡ä¸‹é™ (æé«˜ DW/FW)
- **å…©è€…å…±åŒä½œç”¨ï¼Œç¼ºä¸€ä¸å¯** (v6.7 æ¸¬è©¦è­‰å¯¦)

### 2.3 èŠ±é’ç´ åˆæˆæ©Ÿåˆ¶ â­â­â­

**v6.7 æœ€çµ‚è¨­è¨ˆ**: f(ç¬æ™‚ Stress, FW)

**å…¬å¼**:
```python
FW_kg_m2 = X_d / calculate_dynamic_dw_fw_ratio(Stress, p)
synthesis_rate = FW_kg_m2 Ã— (base_synthesis + V_max Ã— Stress / (K_stress + Stress))
degradation_rate = k_deg Ã— Anth
dAnth/dt = synthesis_rate - degradation_rate
```

**é—œéµç‰¹æ€§**:
- âœ… ä½¿ç”¨ç¬æ™‚ Stress (ç…§å°„æ™‚é«˜ï¼Œä¸ç…§å°„æ™‚ä½)
- âœ… æ­£æ¯”æ–¼ FW (æ¤ç‰©å¯¦éš›å¤§å°)
- âœ… è‡ªç„¶é¿å…é•·æœŸç´¯ç©å•é¡Œ
- âœ… é¿å… LAI-FW è„«é‰¤å•é¡Œ

---

## ä¸‰ã€v6.7 æ¼”åŒ–æ­·ç¨‹ (èŠ±é’ç´ å„ªåŒ–)

### 3.1 v6.4 â†’ v6.6: é®®é‡é”æ¨™ï¼ŒèŠ±é’ç´ å¾…æ”¹å–„

**v6.4**: 6/6 FW <5% âœ…ï¼ŒèŠ±é’ç´ æœªå„ªåŒ–
**v6.5**: èŠ±é’ç´ æ”¹ç”¨ E_stress (ç´¯ç©èƒ½é‡)
**v6.6**: èŠ±é’ç´ æ”¹ç”¨ LAI ä¾è³´
- çµæœ: 6/6 FW <5%, 5/6 Anth <10% (L6D12: +10.5%)

### 3.2 v6.7: ç§»é™¤ E_stress + ä¸‰ç¨®æ–¹æ¡ˆæ¸¬è©¦

#### æ–¹æ¡ˆ 1: LAI-based (ç„¡ LDMC) âŒ

**å‡è¨­**: LDMC ç”± intraday_factor å–ä»£ï¼Œå¯ç§»é™¤
- ç§»é™¤ LDMC å‹•æ…‹è®ŠåŒ–
- èŠ±é’ç´ æ”¹ç”¨ LAI ä¾è³´

**çµæœ**:
- H12D3: FW +39.8% âŒ (åŸæœ¬ +2.1%)
- L6D12: FW +9.3% âŒ (åŸæœ¬ -2.3%)

**çµè«–**: LDMC ä¸å¯ç§»é™¤ï¼Œèˆ‡ intraday_factor å„å¸å…¶è·

#### æ–¹æ¡ˆ 2: LAI-based (æœ‰ LDMC) âŒ

**è¨­è¨ˆ**: ä¿ç•™ LDMCï¼ŒèŠ±é’ç´ ä½¿ç”¨ LAI ä¾è³´

**çµæœ**:
- FW: 6/6 <5% âœ…
- Anth: æ‰€æœ‰çµ„ +200-300% âŒ

**å•é¡Œ**: LAI-FW è„«é‰¤
- LDMC å‹•æ…‹å°è‡´ LAI èˆ‡ FW ä¸æˆæ­£æ¯”
- é«˜ LDMC â†’ é«˜ LAI/FW æ¯”ä¾‹
- L6D12: å°é¡†æ¤ç‰© (ä½ FW) ä½†é«˜ LAI â†’ é«˜ä¼°èŠ±é’ç´  +268%

#### æ–¹æ¡ˆ 3: FW-based (æœ‰ LDMC) âœ…

**è¨­è¨ˆ**: ä¿ç•™ LDMCï¼ŒèŠ±é’ç´ ä½¿ç”¨ FW ä¾è³´

**çµæœ**:
- FW: 6/6 <5% âœ…
- Anth: 6/6 <10% âœ…

**å„ªå‹¢**:
- ç›´æ¥åæ˜ æ¤ç‰©å¯¦éš›å¤§å°
- é¿å… LAI-FW è„«é‰¤å•é¡Œ
- æ‰€æœ‰çµ„é”æ¨™

---

## å››ã€é—œéµæ´å¯Ÿ

### 4.1 LDMC çš„å¿…è¦æ€§

| å‡è¨­ | æ¸¬è©¦ | çµæœ | çµè«– |
|------|------|------|------|
| LDMC ç”± intraday_factor å–ä»£ | ç§»é™¤ LDMC | H12D3 FW +39.8% âŒ | LDMC ä¸å¯ç§»é™¤ |
| LDMC èˆ‡ intraday_factor ç¨ç«‹ | ä¿ç•™ LDMC | H12D3 FW +2.1% âœ… | å…©è€…å„å¸å…¶è· |

**LDMC èˆ‡ intraday_factor åˆ†å·¥**:
- `intraday_factor`: æå‚·æ”¾å¤§æ©Ÿåˆ¶ (>200x)
- `LDMC`: é®®é‡ä¸‹é™æ©Ÿåˆ¶ (æé«˜ DW/FW)
- ç¼ºä¸€ä¸å¯

### 4.2 LAI-FW è„«é‰¤å•é¡Œ

**ç¾è±¡**: LDMC å‹•æ…‹å°è‡´ LAI èˆ‡ FW ä¸æˆæ­£æ¯”

**æ©Ÿåˆ¶**:
```
é«˜ Stress â†’ é«˜ LDMC â†’ é«˜ DW/FW
DW = å›ºå®š â†’ FW ä¸‹é™
LAI = f(DW) â†’ LAI ç¶­æŒ
çµæœ: LAI/FW æ¯”ä¾‹ä¸Šå‡
```

**å½±éŸ¿**:
- L6D12: å°é¡†æ¤ç‰© (FW=59.0g) ä½†é«˜ LAI
- LAI-based èŠ±é’ç´ : +268% (åš´é‡é«˜ä¼°)
- FW-based èŠ±é’ç´ : +2.4% (æ­£ç¢º)

**ç”¨æˆ¶é—œéµæ´å¯Ÿ**:
> "æ¤ç‰©LDMCé«˜ ä»£è¡¨å¾ˆä¹¾å¾ˆå°é¡†"

### 4.3 ç¬æ™‚ Stress vs ç´¯ç© E_stress

| æ–¹æ¡ˆ | ç‹€æ…‹è®Šé‡ | å„ªé» | ç¼ºé» |
|------|---------|------|------|
| E_stress (ç´¯ç©) | 6 å€‹ | æ˜ç¢ºç´¯ç©æ¦‚å¿µ | å¤šä¸€å€‹ç‹€æ…‹è®Šé‡ |
| Stress (ç¬æ™‚) | 5 å€‹ | ç°¡æ½”ï¼Œè‡ªç„¶é¿å…ç´¯ç© | éœ€ç†è§£ç¬æ™‚æ©Ÿåˆ¶ |

**v6.7 çµè«–**: ç¬æ™‚ Stress è¶³å¤ ï¼Œç§»é™¤ E_stress
- ç…§å°„æ™‚ Stress é«˜ â†’ åˆæˆå¿«
- ä¸ç…§å°„æ™‚ Stress ä½ â†’ åˆæˆæ…¢
- è‡ªç„¶é¿å…é•·æœŸç´¯ç©å•é¡Œ

---

## äº”ã€é—œéµåƒæ•¸ (v6.7)

### 5.1 Stress æå‚·èˆ‡ä¿®å¾©

```python
STRESS_PARAMS = {
    'stress_damage_coeff': 0.66e-6,        # æå‚·ä¿‚æ•¸
    'stress_repair_coeff': 1.0e-5,         # ä¿®å¾©ä¿‚æ•¸
    'stress_nonlinear_coeff': 8.0,         # Stress ç´¯ç©éç·šæ€§
    'K_nonlinear': 0.8,                    # éç·šæ€§åŠé£½å’Œå¸¸æ•¸

    # LAI è„†å¼±æ€§ (VL3D12, L6D12)
    'LAI_ref_vuln': 6.5,                   # è„†å¼±æ€§åƒè€ƒ LAI
    'n_vuln': 8,                           # è„†å¼±æ€§æŒ‡æ•¸
    'cap_vuln': 100.0,                     # è„†å¼±æ€§ä¸Šé™

    # æ—¥å…§èƒ½é‡éç·šæ€§ (H12D3 é—œéµ) â­
    'E_50': 475.2,                         # åŠé£½å’Œèƒ½é‡ [kJ/mÂ²] â‰ˆ 6h @ 22 W/mÂ²
    'E_scale': 237.6,                      # èƒ½é‡å°ºåº¦ [kJ/mÂ²]
    'k_intraday': 49.0,                    # éç·šæ€§æ”¾å¤§ä¿‚æ•¸
    'm_intraday': 2.0,                     # æŒ‡æ•¸
    'sharpness_intraday': 3.0,             # softplus éŠ³åº¦

    # å¤œé–“ç¯€å¾‹æå‚· (L6D6-N é—œéµ)
    'circadian_disruption_factor': 3.0,    # å¤œé–“æå‚·åŠ æˆ

    # Stress å°ç”Ÿé•·æŠ‘åˆ¶
    'stress_photosynthesis_inhibition': 0.66,
    'stress_lai_inhibition': 0.66,
    'K_stress': 1.9,
}
```

### 5.2 èŠ±é’ç´ åƒæ•¸ (v6.7: FW-based)

```python
ANTHOCYANIN_PARAMS = {
    # åŸºç¤åˆæˆ (ç„¡ UVA æ™‚) - per FW
    'base_anth_rate_light': 2.0e-10,       # æ—¥é–“ [kg Anth / (kg FW Â· s)]
    'base_anth_rate_dark': 1.0e-10,        # å¤œé–“ [kg Anth / (kg FW Â· s)]

    # Stress èª˜å°åˆæˆ - per FW
    'V_max_anth': 2.35e-11,                # æœ€å¤§èª˜å° [kg Anth / (kg FW Â· s)]
    'K_stress_anth': 0.30,                 # Stress åŠé£½å’Œå¸¸æ•¸

    # é™è§£
    'k_deg': 3.02e-6,                      # é™è§£ç‡ [1/s]

    # ç¢³æˆæœ¬
    'anth_carbon_cost': 0.0,               # è¨­ç‚º 0 (å°å€¼ä¹Ÿéåº¦æŠ‘åˆ¶)
}
```

### 5.3 LDMC åƒæ•¸ (v6.7: ä¿ç•™å‹•æ…‹)

```python
LDMC_PARAMS = {
    'dw_fw_ratio_base': 0.05,              # åŸºç¤ DW/FW (5%)
    'ldmc_stress_sensitivity': 1.0,        # LDMC å° Stress æ•æ„Ÿåº¦
    'K_ldmc': 50.0,                        # LDMC åŠé£½å’Œ Stress
    'dw_fw_ratio_max': 0.12,               # æœ€å¤§ DW/FW (12%)
}
```

---

## å…­ã€ç‰ˆæœ¬æ¼”åŒ–æ­·å²

### v6.0 â†’ v6.3: é®®é‡æ ¡æº–éšæ®µ
- v6.0: åƒæ•¸å¤–éƒ¨åŒ–åˆ° `params_config.py`
- v6.1: ä¿®å¾©æ™‚é–“è¨ˆç®— Bug
- v6.2: æé«˜æŠ‘åˆ¶éˆæ•åº¦
- v6.3: L6D6 å„ªå…ˆç©©å®š + æ©Ÿåˆ¶åˆ†é›¢ (5/6 çµ„ FW é”æ¨™)

### v6.4: æ—¥å…§éç·šæ€§å„ªåŒ– â­
- ä¿®æ­£ `I_UVA_config` Bug (22 W/mÂ²)
- `k_intraday`: 2.0 â†’ 50.0 (å¤§å¹…æé«˜ H12D3 æŠ‘åˆ¶)
- **çµæœ**: 6/6 çµ„ FW <5% âœ…

### v6.5 â†’ v6.6: èŠ±é’ç´ åˆæ­¥å„ªåŒ–
- v6.5: èŠ±é’ç´ æ”¹ç”¨ E_stress (ç´¯ç©èƒ½é‡)
- v6.6: èŠ±é’ç´ æ”¹ç”¨ LAI ä¾è³´
- **çµæœ**: 6/6 FW <5%, 5/6 Anth <10%

### v6.7: èŠ±é’ç´ æœ€çµ‚å„ªåŒ– (Final) â­â­â­
- ç§»é™¤ `E_stress` ç‹€æ…‹è®Šé‡
- èŠ±é’ç´ æ”¹ç”¨ç¬æ™‚ Stress é©…å‹•
- æ¸¬è©¦ 3 ç¨®æ–¹æ¡ˆ (LAI ç„¡ LDMC, LAI æœ‰ LDMC, FW æœ‰ LDMC)
- **æœ€çµ‚æ¡ç”¨**: FW-based + ä¿ç•™ LDMC
- **çµæœ**: 6/6 FW <5%, 6/6 Anth <10% âœ…âœ…

---

## ä¸ƒã€æ–‡ä»¶çµæ§‹

```
uva-simulation/
â”œâ”€â”€ simulate_uva_model.py         # ä¸»æ¨¡å‹ (v6.7)
â”œâ”€â”€ params_config.py              # åƒæ•¸é…ç½®
â”œâ”€â”€ model_config.py               # å¯¦é©—è¨­å®š
â”œâ”€â”€ lettuce_uva_carbon_complete_model.py  # Sun åŸºç¤æ¨¡å‹
â”œâ”€â”€ test_v66_all_groups.py        # é©—è­‰è…³æœ¬
â”œâ”€â”€ V64_FINAL_REPORT.md           # æœ¬æ–‡ä»¶ (æœ€çµ‚å ±å‘Š)
â”œâ”€â”€ MODEL_DESIGN_NOTES.md         # è¨­è¨ˆç­†è¨˜
â”œâ”€â”€ HANDOFF_STATUS.md             # äº¤æ¥ç‹€æ…‹
â””â”€â”€ CLAUDE.md                     # Claude å·¥ä½œå®ˆå‰‡
```

---

## å…«ã€æ¨¡å‹é™åˆ¶èˆ‡æœªä¾†æ–¹å‘

### 8.1 ç•¶å‰é™åˆ¶

1. **èŠ±é’ç´ ç¢³æˆæœ¬**:
   - `anth_carbon_cost = 0.0` (å°å€¼ä¹Ÿéåº¦æŠ‘åˆ¶)
   - å¯èƒ½è¡¨ç¤ºåŸºç¤åˆæˆç‡è¨­å®šæœ‰å•é¡Œ

2. **FW éç‹€æ…‹è®Šé‡**:
   - FW éœ€å¾ `Xd` èˆ‡ `Stress` å³æ™‚è¨ˆç®—
   - å¢åŠ è¨ˆç®—è² æ“”

3. **LDMC æ©Ÿåˆ¶ç°¡åŒ–**:
   - ç•¶å‰åƒ…ä¾è³´ Stress
   - æœªè€ƒæ…®é¤Šåˆ†ã€æ°´åˆ†ç­‰å› ç´ 

### 8.2 æœªä¾†æ”¹é€²æ–¹å‘

1. é‡æ–°æª¢è¦–èŠ±é’ç´ ç¢³æˆæœ¬æ©Ÿåˆ¶
2. è€ƒæ…® FW ä½œç‚ºç‹€æ…‹è®Šé‡çš„å¯èƒ½æ€§
3. æ¢ç´¢æ›´è¤‡é›œçš„ LDMC å‹•æ…‹æ©Ÿåˆ¶
4. ä½¿ç”¨ç¨ç«‹æ•¸æ“šé›†é©—è­‰æ¨¡å‹æ³›åŒ–èƒ½åŠ›

---

## ä¹ã€è‡´è¬

- **Sun et al. åŸºç¤æ¨¡å‹**: æä¾›å…‰åˆä½œç”¨èˆ‡ç”Ÿé•·åŸºç¤
- **ç”¨æˆ¶æ´å¯Ÿ**: "æ¤ç‰©LDMCé«˜ ä»£è¡¨å¾ˆä¹¾å¾ˆå°é¡†" - é—œéµç†è§£ LAI-FW è„«é‰¤å•é¡Œ
- **å¯¦é©—æ•¸æ“š**: 6 çµ„è™•ç†æä¾›å……åˆ†æ ¡æº–è³‡æ–™

---

## åã€çµè«–

**v6.7 æ¨¡å‹æˆåŠŸé”æˆæ‰€æœ‰ç›®æ¨™**:
- âœ… 6/6 é®®é‡é æ¸¬ <5%
- âœ… 6/6 èŠ±é’ç´ é æ¸¬ <10%
- âœ… ç‰©ç†æ©Ÿåˆ¶æ¸…æ™°
- âœ… åƒæ•¸åˆç†ç©©å®š

**é—œéµæˆåŠŸå› ç´ **:
1. **æ©Ÿåˆ¶åˆ†é›¢**: å„çµ„ä½¿ç”¨ç‰¹å®šæ©Ÿåˆ¶ï¼Œé¿å…äº’ç›¸å¹²æ“¾
2. **LDMC ä¿ç•™**: èˆ‡ intraday_factor å…±åŒè§£é‡‹ H12D3/L6D12
3. **FW-based èŠ±é’ç´ **: é¿å… LAI-FW è„«é‰¤å•é¡Œ
4. **ç¬æ™‚ Stress**: ç°¡åŒ–æ¨¡å‹ï¼Œè‡ªç„¶é¿å…ç´¯ç©å•é¡Œ

**æ¨¡å‹å·²å¯ç”¨æ–¼**:
- é æ¸¬ä¸åŒ UVA è™•ç†å°èµè‹£ç”Ÿé•·çš„å½±éŸ¿
- é æ¸¬èŠ±é’ç´ ç´¯ç©å‹•æ…‹
- è¨­è¨ˆæœ€ä½³ UVA ç…§å°„ç­–ç•¥

---

**ç‰ˆæœ¬**: v6.7
**æ—¥æœŸ**: 2025-12-23
**ç‹€æ…‹**: âœ… ç”Ÿç”¢å°±ç·’ (12/12 ç›®æ¨™é”æˆ)

**ğŸ‰ æ­å–œï¼æ¨¡å‹å·²é”åˆ° 100% å®Œç¾é”æ¨™ï¼**
