# Stress 校準困境

**日期**: 2025-12-22
**問題**: 無論如何調整 Stress 參數，都無法讓 L6D6 預測促進效應

---

## 📊 實驗觀察

| 處理組 | 實驗 FW | LED | UVA | 日均光強 | vs CK |
|--------|---------|-----|-----|----------|-------|
| **CK** | 87.0g | 57 W/m² | 0 | 57 W/m² | - |
| **L6D6** | **91.4g** | 57 W/m² | 22 W/m² (6h/day) | **68 W/m²** | **+5.1%** ✅ |

**關鍵發現**: L6D6 的日間平均光強比 CK 高 **19.3%**，帶來 **5.1%** 鮮重增長

---

## 🔬 模型預測 (當前最佳參數)

### 參數設定

```python
stress_damage_coeff = 0.8e-6      # 已降低 77%
stress_photosynthesis_inhibition = 0.50  # 已降低 29%
E_50 = 800.0 kJ/m²                # 已提高 237%
```

### 預測結果

| 處理組 | 預測 FW | 目標 FW | 誤差 | 狀態 |
|--------|---------|---------|------|------|
| CK | 87.8g | 87.0g | +1.0% | ✅ 準確 |
| **L6D6** | **69.2g** | 91.4g | **-24.3%** | ❌ 嚴重低估 |
| H12D3 | 72.0g | 60.6g | +18.9% | ⚠️ 高估 |

**矛盾**:
- CK 預測準確 (+1.0%)
- L6D6 嚴重低估 (-24.3%)
- 額外 19.3% 光強 → 預測 -21.2% 鮮重下降 ❌

---

## 🎯 根本矛盾

### 理論預期 (無 Stress)

基於 Sun 原始模型測試：
- 57 W/m²: 86.7g
- 79 W/m²: 90.6g (+4.6%)

L6D6 日均光強 68 W/m²，應該介於兩者之間：
- **預期**: 約 88-89g (+2-3%)

### 實際模型預測

- L6D6: **69.2g** (-21% vs CK)

### 差距分析

```
輻射促進效應: +2-3%  (Sun 模型證明)
Stress 抑制效應: -24%  (模型預測)
淨效應: -21%  ❌
```

**問題**: 即使大幅降低 Stress 參數，抑制效應仍然遠大於促進效應

---

## 🔍 參數調整歷程

| 迭代 | stress_damage_coeff | inhibition | L6D6 預測 | 誤差 |
|------|---------------------|------------|-----------|------|
| v0 (原始) | 3.5e-6 | 0.70 | 58.6g | -35.9% |
| v1 | 1.5e-6 | 0.35 | 74.7g | -18.3% |
| v2 | 1.0e-6 | 0.45 | 72.3g | -20.9% |
| v3 | 1.5e-6, E_50=600 | 0.35 | 74.7g | -18.3% |
| **v4 (當前)** | **0.8e-6** | **0.50** | **69.2g** | **-24.3%** |

**觀察**:
- 降低 `stress_damage_coeff` 反而讓 L6D6 更差
- 調整 E_50 沒有改善
- **無論如何調整，L6D6 始終低於 CK**

---

## 💡 可能的原因

### 1. 模型結構問題 ❓

**假設**: UVA 模型在 UVA 照射期間的處理有問題

可能的bug:
- UVA 照射時 Stress 累積過快
- 即使低劑量也觸發某些隱藏機制
- 光合促進效應被某個機制抵消

### 2. 缺少激效 (Hormesis) 機制 ⭐

**生物學事實**:
- 低劑量壓力可能**激活防禦系統**，促進生長
- 當前模型只有損傷-修復，沒有激效

**建議**: 增加激效機制
```python
if Stress < threshold:
    growth_promotion = hormesis_factor * Stress
else:
    growth_inhibition = inhibition_factor * Stress
```

### 3. 花青素基礎合成過高 ⭐⭐

**發現**: `base_anth_rate_light = 4.0e-10` 可能過高 22倍

**影響**:
- 即使 `anth_carbon_cost = 0`，花青素合成仍消耗資源
- 花青素合成可能競爭氮素、能量等

**證據**:
- 花青素預測誤差降到 11.5% (從 35.7%)
- 但鮮重仍然很低

### 4. 參數耦合問題 ⭐⭐⭐

**觀察**:
- `stress_damage_coeff` 從 3.5e-6 → 0.8e-6 (降低 77%)
- L6D6 從 58.6g → 69.2g (改善 18%)
- 但仍遠低於目標 91.4g (差距 24%)

**問題**: 參數之間可能存在非線性耦合
- 降低 `stress_damage_coeff` 會降低 Stress
- 但同時也降低了 `stress_nonlinear_coeff` 的作用
- 導致高劑量組 (H12D3) 過度高估

---

## 🚨 困境總結

### 核心矛盾

1. **CK 預測準確** (+1.0%)
   - 證明基礎模型正確
   - `c_alpha = 0.548` 校準良好

2. **L6D6 嚴重低估** (-24.3%)
   - 有額外 22 W/m² 輻射
   - 應該促進生長，實際預測抑制生長
   - 與實驗矛盾

3. **參數調整無效**
   - 降低損傷係數 → L6D6 更差
   - 提高 E_50 → 無改善
   - 降低抑制強度 → H12D3 過度高估

### 平衡點不存在？

```
如果 stress_damage_coeff 太高:
  → L6D6 低估 (Stress 太多)
  → H12D3 也低估

如果 stress_damage_coeff 太低:
  → L6D6 仍然低估 (為什麼？)
  → H12D3 高估 (Stress 太少)

無論如何調整:
  → L6D6 < CK (違背物理邏輯)
```

---

## 🎯 可能的解決方案

### 方案 A: 檢查模型實現 bug ⭐⭐⭐

**懷疑**: UVA 照射期間的處理有問題

**行動**:
1. 逐步追蹤 L6D6 在 UVA 照射期間的狀態變化
2. 檢查 `uva_sun_derivatives` 函數
3. 確認有效光強度計算正確
4. 檢查 Stress 累積是否異常

### 方案 B: 增加激效機制 ⭐⭐

**理論**: 低劑量 UVA 促進生長

**實現**:
```python
if Stress < hormesis_threshold:
    growth_factor = 1 + hormesis_coeff * Stress
else:
    growth_factor = 1 - inhibition_coeff * Stress
```

### 方案 C: 重新校準花青素基礎合成 ⭐

**問題**: `base_anth_rate_light = 4.0e-10` 過高

**行動**:
- 降低到 `1.8e-11` (原值的 4.5%)
- 觀察鮮重預測是否改善

### 方案 D: 使用優化算法自動搜索最佳參數 ⭐⭐

**方法**: 使用 scipy.optimize 最小化誤差

**目標函數**:
```python
def objective(params):
    errors = []
    for treatment in ['CK', 'L6D6', 'L6D6-N', 'H12D3']:
        pred_fw = simulate(treatment, params)
        error = abs(pred_fw - target_fw) / target_fw
        errors.append(error)
    return sum(errors)
```

---

## 📌 下一步建議

### 立即執行 (優先級 1)

1. **檢查模型 bug**
   - 追蹤 L6D6 Day 30 12:00 的詳細計算
   - 驗證有效光強度 = 79 W/m²
   - 檢查 Sun 模型調用是否正確

2. **降低花青素基礎合成**
   - `base_anth_rate_light: 4.0e-10 → 1.0e-10`
   - 測試鮮重預測變化

### 中期方案 (優先級 2)

3. **增加激效機制**
   - 設計 hormesis 函數
   - 校準閾值和係數

4. **參數優化**
   - 使用優化算法自動搜索
   - 最小化所有處理組誤差

---

## ✅ 結論

**當前狀態**: Stress 參數調整遇到瓶頸

**核心問題**: L6D6 預測促進效應始終無法實現

**最可能原因**:
1. 模型實現有 bug (需要深入檢查)
2. 缺少激效機制
3. 花青素基礎合成過高

**建議**: 優先檢查模型實現，特別是 UVA 照射期間的光強度計算和 Stress 累積
