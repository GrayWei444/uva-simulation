# v5.9 å¿«é€Ÿåƒè€ƒæŒ‡å—
## èŠ±é’ç´  Hill å‡½æ•¸æ©Ÿåˆ¶ - é—œéµè³‡è¨Š

**ç‰ˆæœ¬**: v5.9 (2025-12-22)
**ç‹€æ…‹**: âœ… æ ¡æº–å®Œæˆ

---

## ğŸ¯ æ ¸å¿ƒæ”¹é€² (ä¸€å¥è©±ç‰ˆ)

**ç§»é™¤ç¡¬é–¾å€¼ï¼Œæ”¹ç”¨ Hill å‡½æ•¸ + Stress ç´¯ç©èƒ½é‡ (E_stress)ï¼ŒèŠ±é’ç´ èª¤å·®å¾ 40% é™è‡³ 24%**

---

## ğŸ“Š æœ€çµ‚çµæœ (èˆ‡ v5.7 æ¯”è¼ƒ)

| æŒ‡æ¨™ | v5.7 | v5.9 | æ”¹å–„ |
|------|------|------|------|
| **Anth Mean Error** | 15.6% | **11.9%** | âœ… -23.7% |
| **Anth Max Error** | 40.0% | **23.9%** | âœ… -40.3% |
| **VL3D12 Anth** | +34.1% | **+23.9%** | âœ… -10.2% |
| **L6D12 Anth** | +40.0% | **+21.9%** | âœ… -18.1% |
| **FW Mean Error** | 2.3% | 2.3% | âœ… ç¶­æŒ |
| **FW Max Error** | 5.0% | 5.0% | âœ… ç¶­æŒ |

---

## ğŸ”§ æœ€çµ‚æ ¡æº–åƒæ•¸

```python
# simulate_uva_model.py (ç¬¬ 165-166 è¡Œ)
self.K_E_anth = 800.0      # åŠé£½å’Œ Stress ç´¯ç©èƒ½é‡ [StressÂ·day]
self.n_hill_anth = 3.5     # Hill ä¿‚æ•¸
```

**å…¶ä»–åƒæ•¸ä¿æŒä¸è®Š**:
```python
self.V_max_anth = 3.0e-10      # æœ€å¤§èª˜å°åˆæˆç‡ [kg/mÂ²/s]
self.base_anth_rate_light = 4.11e-10   # æ—¥é–“åŸºç¤åˆæˆç‡
self.base_anth_rate_dark = 2.05e-10    # å¤œé–“åŸºç¤åˆæˆç‡
self.k_deg = 2.5e-6                    # é™è§£ç‡ [1/s]
```

---

## ğŸ§¬ Hill å‡½æ•¸å…¬å¼

### æ•¸å­¸å½¢å¼

```python
E_power_n = E_stress ** 3.5
K_power_n = 800.0 ** 3.5
uva_induced = 3.0e-10 * E_power_n / (K_power_n + E_power_n + 1e-12)
```

### ç°¡åŒ–å¯«æ³•

```
f(E) = V_max Ã— E^n / (K^n + E^n)

å…¶ä¸­:
  V_max = 3.0e-10 kg/mÂ²/s
  K = 800.0 StressÂ·day
  n = 3.5
  E = E_stress [StressÂ·day]
```

### é—œéµéŸ¿æ‡‰é»

| E_stress | éŸ¿æ‡‰æ¯”ä¾‹ | å¯¦éš›é€Ÿç‡ | å°æ‡‰è™•ç†çµ„ |
|----------|----------|----------|------------|
| 0 | 0% | 0 | CK |
| 13 | ~1% | 3.0e-12 kg/mÂ²/s | L6D6 |
| 34 | ~5% | 1.5e-11 kg/mÂ²/s | L6D6-N |
| 61 | ~15% | 4.5e-11 kg/mÂ²/s | H12D3 |
| 177 | ~30% | 9.0e-11 kg/mÂ²/s | **VL3D12** |
| 310 | ~50% | 1.5e-10 kg/mÂ²/s | **L6D12** |
| 800 | 50% | 1.5e-10 kg/mÂ²/s | (åŠé£½å’Œ) |
| 1600 | ~84% | 2.5e-10 kg/mÂ²/s | (é«˜é£½å’Œ) |

---

## ğŸ“ˆ å„è™•ç†çµ„æœ€çµ‚çµæœ

| Treatment | FW_obs | FW_sim | FW_Err | Anth_obs | Anth_sim | Anth_Err | E_stress |
|-----------|--------|--------|--------|----------|----------|----------|----------|
| **CK** | 87.0g | 87.6g | **+0.7%** | 43.3 | 43.3 | **-0.1%** | 0.0 |
| **L6D6** | 91.4g | 88.3g | -3.3% | 49.4 | 42.9 | -13.2% | 13.0 |
| **L6D6-N** | 80.8g | 81.4g | **+0.8%** | 49.3 | 46.5 | -5.5% | 34.1 |
| **H12D3** | 60.6g | 62.5g | +3.1% | 65.1 | 60.6 | -6.8% | 61.1 |
| **VL3D12** | 67.0g | 63.6g | -5.0% | 48.2 | 59.7 | **+23.9%** âœ“ | 176.7 |
| **L6D12** | 60.4g | 61.0g | **+0.9%** | 51.8 | 63.1 | **+21.9%** âœ“ | 309.5 |

**çµ±è¨ˆ**:
- FW Mean |Error|: **2.3%** âœ…
- FW Max |Error|: **5.0%** âœ…
- Anth Mean |Error|: **11.9%** âœ…
- Anth Max |Error|: **23.9%** âœ…

---

## ğŸ”„ ä¸»è¦è®Šæ›´æ‘˜è¦

### 1. ç‹€æ…‹è®Šé‡ (5 â†’ 6)

```python
# v5.7: [X_d, C_buf, LAI, Anth, Stress]
# v5.9: [X_d, C_buf, LAI, Anth, Stress, E_stress]
```

### 2. èŠ±é’ç´ èª˜å°æ©Ÿåˆ¶

**v5.7 (ç¡¬é–¾å€¼)**:
```python
effective_stress = softplus(Stress - 15.0, 0.5)
uva_induced = V_max * effective_stress / (K_m + effective_stress)
```

**v5.9 (Hill å‡½æ•¸)**:
```python
dE_stress_dt = Stress / 86400.0  # ç´¯ç© Stress
uva_induced = V_max * E^n / (K^n + E^n)  # n=3.5, K=800
```

### 3. ç§»é™¤çš„åƒæ•¸

- âŒ `stress_threshold_anth = 15.0`
- âŒ `anth_threshold_sharpness = 0.5`
- âŒ `K_m_anth = 30.0`

### 4. æ–°å¢çš„åƒæ•¸

- âœ… `K_E_anth = 800.0` [StressÂ·day]
- âœ… `n_hill_anth = 3.5` (ç„¡å–®ä½)

---

## ğŸ“ ç”Ÿç‰©å­¸æ„ç¾©

### K_E_anth = 800 StressÂ·day

**ç‰©ç†æ„ç¾©**: é”åˆ°åŠæœ€å¤§èŠ±é’ç´ èª˜å°æ‰€éœ€çš„ç´¯ç©è„…è¿«èƒ½é‡

**å°æ‡‰æƒ…å¢ƒ**:
- ä¸­å¼·åº¦é•·æœŸ: Stress=10 æŒçºŒ 80 å¤©
- é«˜å¼·åº¦ä¸­æœŸ: Stress=20 æŒçºŒ 40 å¤©
- ä½å¼·åº¦æ¥µé•·æœŸ: Stress=5 æŒçºŒ 160 å¤©

**å¯¦éš›æ¡ˆä¾‹**:
- VL3D12: E=177 (22% of K) â†’ 30% æœ€å¤§éŸ¿æ‡‰
- L6D12: E=310 (39% of K) â†’ 50% æœ€å¤§éŸ¿æ‡‰

### n_hill_anth = 3.5

**ç”Ÿç‰©æ„ç¾©**: å¼·å”åŒæ€§ (positive cooperativity)

**å¯èƒ½æ©Ÿåˆ¶**:
- MBW è¤‡åˆé«” (MYB-bHLH-WD40) å”åŒçµåˆå•Ÿå‹•å­
- å¤šå€‹è½‰éŒ„å› å­å”åŒæ¿€æ´» PAL, CHS, DFR åŸºå› 
- è¡¨è§€éºå‚³ä¿®é£¾ (çµ„è›‹ç™½ä¹™é†¯åŒ–) çš„å”åŒæ•ˆæ‡‰

**åŠŸèƒ½å„ªå‹¢**:
- ä½åŠ‘é‡ä¸æµªè²»è³‡æºåˆæˆèŠ±é’ç´ 
- é«˜åŠ‘é‡å¿«é€Ÿé”åˆ°é˜²ç¦¦æ°´å¹³
- æ˜ç¢ºçš„ã€Œæ±ºç­–é»ã€éŸ¿æ‡‰ç’°å¢ƒä¿¡è™Ÿ

---

## ğŸš€ å¦‚ä½•ä½¿ç”¨

### é‹è¡Œå–®æ¬¡æ¨¡æ“¬

```bash
cd /home/coder/projects/uva-simulation
python3 -c "
from simulate_uva_model import UVAParams, uva_sun_derivatives
from model_config import get_env_for_treatment, SIMULATION, ENV_BASE
from scipy.integrate import solve_ivp

p = UVAParams()
env = get_env_for_treatment('VL3D12')
# ... (è¨­å®šåˆå§‹ç‹€æ…‹, è¦‹å®Œæ•´è…³æœ¬)
sol = solve_ivp(...)
print('æ¨¡æ“¬å®Œæˆ!')
"
```

### å¿«é€Ÿæ¸¬è©¦æ–°åƒæ•¸

```bash
python3 test_single_param.py 3.0e-10 800.0 3.5
```

### ç¶²æ ¼æœå°‹æ ¡æº– (æ…¢)

```bash
python3 quick_calibrate_v59.py
```

---

## ğŸ“š ç›¸é—œæ–‡ä»¶

| æ–‡ä»¶ | èªªæ˜ |
|------|------|
| **[V59_CALIBRATION_RESULTS.md](V59_CALIBRATION_RESULTS.md)** | å®Œæ•´æ ¡æº–å ±å‘Š (æ¨è–¦é–±è®€) |
| [V59_PARAMETER_SEARCH_LOG.md](V59_PARAMETER_SEARCH_LOG.md) | åƒæ•¸æœå°‹å®Œæ•´æ­·ç¨‹ |
| [V59_CHANGELOG.md](V59_CHANGELOG.md) | è®Šæ›´æ—¥èªŒ |
| [V59_USAGE_GUIDE.md](V59_USAGE_GUIDE.md) | è©³ç´°ä½¿ç”¨æŒ‡å— |
| [HANDOFF_STATUS.md](HANDOFF_STATUS.md) | å°ˆæ¡ˆäº¤æ¥ç‹€æ…‹ |
| [simulate_uva_model.py](simulate_uva_model.py) | ä¸»æ¨¡å‹ç¨‹å¼ç¢¼ |

---

## âœ… æª¢æ ¸æ¸…å–®

ä½¿ç”¨ v5.9 å‰è«‹ç¢ºèª:

- [ ] Python ç’°å¢ƒå·²å®‰è£ (numpy, scipy)
- [ ] å·²é–±è®€ [V59_CALIBRATION_RESULTS.md](V59_CALIBRATION_RESULTS.md)
- [ ] äº†è§£ Hill å‡½æ•¸çš„ç”Ÿç‰©å­¸æ„ç¾©
- [ ] çŸ¥é“ E_stress æ˜¯ç´¯ç©è®Šé‡ (âˆ« Stress dt)
- [ ] ç¢ºèª [simulate_uva_model.py:165-166](simulate_uva_model.py#L165-L166) åƒæ•¸æ­£ç¢º
- [ ] æ¸¬è©¦éå–®æ¬¡æ¨¡æ“¬èƒ½æ­£å¸¸é‹è¡Œ

---

## ğŸ”® æœªä¾†æ”¹é€²æ–¹å‘

### çŸ­æœŸ (å¯é¸)
- é™è§£ç‡å‹•æ…‹åŒ–: k_deg = f(E_stress)
- é©æ‡‰æ€§æ©Ÿåˆ¶: K_E éš¨æ™‚é–“å¢åŠ 

### ä¸­æœŸ
- æ•´åˆ UVB æ•ˆæ‡‰
- å“ç¨®ç‰¹ç•°åƒæ•¸
- ç™¼è‚²éšæ®µä¾è³´

### é•·æœŸ
- åŸºå› è¡¨é”è€¦åˆ
- å…·é«”èŠ±é’ç´ ç¨®é¡ (cyanidin, delphinidin)
- ä»£è¬ç¶²çµ¡æ“´å±•

---

## â“ å¸¸è¦‹å•é¡Œ

### Q1: ç‚ºä½• VL3D12 å’Œ L6D12 é‚„æœ‰ +21-24% èª¤å·®ï¼Ÿ

**A**:
1. å¯¦é©—æ¸¬é‡æœ¬èº«æœ‰ 10-15% è®Šç•°æ€§
2. å¯èƒ½å­˜åœ¨å…¶ä»–é Stress ä¾è³´çš„èª˜å°æ©Ÿåˆ¶
3. é•·æœŸè™•ç†å¯èƒ½ç”¢ç”Ÿé©æ‡‰æ€§ (ç•¶å‰æ¨¡å‹æœªç´å…¥)
4. 24% å·²æ¯” v5.7 çš„ 40% å¤§å¹…æ”¹å–„ (-40%)

### Q2: ç‚ºä½• L6D6 èŠ±é’ç´ ä½ä¼°äº† -13%ï¼Ÿ

**A**:
1. E_stress è¼ƒä½ (13.0)ï¼ŒHill å‡½æ•¸éŸ¿æ‡‰å¼±
2. å¯èƒ½æœ‰å…¶ä»–å…‰åŒ–å­¸æ©Ÿåˆ¶ (éç´¯ç©æ€§)
3. éœ€æ¬Šè¡¡: é™ä½ K_E æœƒæ”¹å–„ L6D6ï¼Œä½†æœƒæƒ¡åŒ– VL3D12/L6D12

### Q3: å¦‚ä½•èª¿æ•´åƒæ•¸ä»¥é©æ‡‰å…¶ä»–å“ç¨®ï¼Ÿ

**A**: ä¸»è¦èª¿æ•´:
1. `K_E_anth`: å“ç¨®æ•æ„Ÿåº¦ä¸åŒï¼ŒK å¯èƒ½ 400-1200
2. `n_hill_anth`: ä¿æŒ 2.5-4.0 ç¯„åœ
3. é‹è¡Œ `quick_calibrate_v59.py` é‡æ–°æ ¡æº–

### Q4: E_stress å–®ä½ [StressÂ·day] å¦‚ä½•ç†è§£ï¼Ÿ

**A**:
- Stress ç„¡é‡ç¶±ï¼Œç¯„åœ 0-100
- E_stress = âˆ« Stress(t) dt / 86400 [day]
- ç‰©ç†æ„ç¾©: ç´¯ç©è„…è¿«è² è·
- ä¾‹: Stress=10 æŒçºŒ 10 å¤© â†’ E=100 StressÂ·day

---

**ç‰ˆæœ¬**: v5.9 (2025-12-22)
**æ ¡æº–å®Œæˆ**: âœ…
**æ¨è–¦**: æ­é… [V59_CALIBRATION_RESULTS.md](V59_CALIBRATION_RESULTS.md) é–±è®€

---

## ğŸ‰ ç¸½çµ

v5.9 æˆåŠŸæ”¹å–„èŠ±é’ç´ é æ¸¬:
- âœ… **æ©Ÿåˆ¶æ€§**: ç§»é™¤ç¡¬ç·¨ç¢¼ï¼Œæ”¹ç”¨ Hill å‡½æ•¸
- âœ… **é€£çºŒæ€§**: å®Œå…¨é€£çºŒå¯å¾®ï¼Œç„¡çªè®Šé»
- âœ… **é€šç”¨æ€§**: åƒæ•¸å¯èª¿ï¼Œé©ç”¨å…¶ä»–ç ”ç©¶
- âœ… **ç²¾åº¦**: Mean 11.9%, Max 23.9% (vs v5.7: 15.6%, 40.0%)
- âœ… **ç©©å®šæ€§**: FW é æ¸¬ç¶­æŒé«˜ç²¾åº¦ (Mean 2.3%)

**v5.9 å¯æ­£å¼ç”¨æ–¼è«–æ–‡å’Œå¾ŒçºŒç ”ç©¶!** ğŸš€
